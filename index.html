<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Grupo A Cobijo</title>

  <meta name="description" content="Tu guía en el camping: eventos, horarios, mapas y contacto del Grupo A Cobijo.">
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0ea5e9">
  <link rel="icon" href="assets/icons/icon-192.png">

  <!-- iOS modo App + status bar -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="apple-touch-icon" href="assets/icons/icon-192.png">

  <!-- Splash iPhone (portrait) con cache-busting -->
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-15pm-portrait.png?v=3" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-15p-portrait.png?v=3"  media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-14-15-plus-portrait.png?v=3" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-12pm-portrait.png?v=3" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-12-14-portrait.png?v=3" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-x-11pro-portrait.png?v=3" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-11r-portrait.png?v=3" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-6-8-se2-portrait.png?v=3" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-5-se1-portrait.png?v=3" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">

  <!-- iPad -->
  <link rel="apple-touch-startup-image" href="assets/splash/ipad-pro-12-9-portrait.png?v=3" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/ipad-pro-11-portrait.png?v=3"    media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/ipad-pro-10-5-portrait.png?v=3"  media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/ipad-9-7-portrait.png?v=3"       media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/ipad-10-9-portrait.png?v=3"      media="(device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">

  <style>
    :root{
      --bg:#ffffff; --card:#f4f9ff; --accent:#0077cc; --muted:#6b7a8c;
      --text:#0a1a2a; --line:#dce7f5; --tint:#eaf4ff; --accent-ink:#064e89;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;background:#fff;color:var(--text)}
    .wrap{max-width:900px;margin:0 auto;padding:24px}

    /* Pre-splash interno (fallback) */
    .app-splash { position: fixed; inset: 0; background:#fff; display:grid; place-items:center; z-index:9999; }
    .app-splash img { width: 180px; height:auto; opacity:.98; }

    /* Header / hero */
    header{display:flex;align-items:center;gap:16px;margin:8px 0 12px;flex-wrap:wrap}
    .logo-img{height:80px;width:auto;object-fit:contain}
    h1{margin:0;font-size:1.4rem}
    .tag{color:var(--muted);font-size:.85rem}
    .spacer{flex:1}
    .pill{border:1px solid var(--line);background:var(--tint);padding:4px 10px;border-radius:999px;font-size:.8rem}
    .lang{appearance:none;border:1px solid var(--line);padding:6px 10px;border-radius:10px;font-weight:600;color:var(--accent-ink)}

    .hero{
      margin:8px 0 18px; background:linear-gradient(180deg,#f8fbff,#eef5ff);
      border:1px solid var(--line); border-radius:16px; padding:16px;
    }
    .hero h2{margin:0 0 6px; font-size:1.2rem}
    .hero p{margin:0; color:var(--muted)}

    /* Cards / grid */
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;margin:16px 0 28px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.06);display:flex;flex-direction:column;gap:12px}
    .card h2{margin:0 0 6px; font-size:1.1rem}

    /* Botones: fix iPhone */
    .row{display:flex;flex-wrap:wrap;gap:8px}
    .btn{
      appearance:none;border:1px solid var(--line);background:rgba(0,119,204,.08);
      color:var(--accent-ink);padding:10px 12px;border-radius:12px;text-decoration:none;
      display:flex;align-items:center;justify-content:center;font-weight:600;
      flex:1; min-width:120px;
    }
    .btn:hover{background:rgba(0,119,204,.14)}

    /* Mapas */
    .map{width:100%;aspect-ratio:16/10;border-radius:12px;overflow:hidden;border:1px solid var(--line)}
    .map iframe{width:100%;height:100%;border:0}

    /* Eventos */
    .event-card{background:#fff;border:1px solid var(--line);border-radius:14px;padding:12px}
    .event-title{font-weight:700}
    .event-meta{font-size:.9rem;color:var(--muted)}

    /* Modal horarios */
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:10001}
    .modal{width:min(92vw,520px);background:#fff;border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:0 10px 28px rgba(0,0,0,.2)}
    .modal .close{background:transparent;border:none;color:var(--muted);font-weight:700;float:right}
    .schedule{border:1px solid var(--line);border-radius:12px;padding:12px;background:#fff}
    .schedule h4{margin:0 0 8px}
    .schedule ul{margin:0;padding-left:18px}
    .schedule li{margin:4px 0}

    footer{margin-top:8px;font-size:.9rem;opacity:.85}
    .ok{color:#21a653}
    .install{display:none}
  </style>
</head>

<body>
  <!-- Pre-splash interno: se oculta al cargar -->
  <div class="app-splash" id="appSplash">
    <img src="assets/logo.png" alt="A Cobijo">
  </div>

  <div class="wrap">
    <!-- Header -->
    <header>
      <img src="assets/logo.png" class="logo-img" alt="Grupo A Cobijo">
      <div>
        <h1 id="t-app">Grupo A Cobijo</h1>
        <div class="tag" id="t-subtitle">Tu estancia con nosotros · Oyambre · Ramales · Ruiloba</div>
      </div>
      <div class="spacer"></div>
      <select id="langSel" class="lang">
        <option value="es">ES</option><option value="en">EN</option><option value="fr">FR</option><option value="de">DE</option><option value="nl">NL</option>
      </select>
      <span class="pill" id="t-pwa">PWA • Offline</span>
    </header>

    <!-- Hero de experiencia -->
    <section class="hero">
      <h2>Tu guía en el camping</h2>
      <p>Eventos, horarios, cómo llegar y contacto — todo en tu móvil, también sin cobertura.</p>
    </section>

    <!-- 1) EVENTOS (PRIMERO) -->
    <section>
      <h2>Eventos hoy y esta semana</h2>
      <div id="events" class="grid"></div>
    </section>

    <!-- 2) HORARIOS -->
    <section class="card">
      <h2>Horarios</h2>
      <p class="hint">Recepción, restaurante, piscina, supermercado... elige tu camping.</p>
      <div class="row">
        <button class="btn" id="h-oy">Ver horarios Oyambre</button>
        <button class="btn" id="h-ra">Ver horarios Ramales</button>
        <button class="btn" id="h-he">Ver horarios Ruiloba</button>
      </div>
    </section>

    <!-- Modal horarios -->
    <div class="modal-backdrop" id="modalHorarios" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal">
        <button class="close" id="closeHorarios" aria-label="Cerrar">✕</button>
        <h3 id="modalTitle">Horarios</h3>
        <div id="scheduleWrap" class="schedule"></div>
      </div>
    </div>

    <!-- 3) CAMPINGS (AL FINAL) -->
    <section style="margin-top:24px">
      <h2>Nuestros campings</h2>

      <div class="grid">
        <article class="card">
          <h2>Camping Caravaning Playa de Oyambre</h2>
          <p class="hint">Todos los servicios · Frente al mar</p>
          <div class="row">
            <a class="btn" href="https://www.oyambre.com" target="_blank" rel="noopener">Web</a>
            <a class="btn" href="tel:+34942711461">Llamar</a>
            <a class="btn" href="https://maps.google.com/?q=Camping+Caravaning+Playa+de+Oyambre" target="_blank" rel="noopener">Cómo llegar</a>
            <a class="btn" href="https://wa.me/34675696212" target="_blank" rel="noopener">WhatsApp</a>
          </div>
          <div class="map"><iframe src="https://www.google.com/maps?q=Camping+Caravaning+Playa+de+Oyambre&output=embed" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe></div>
        </article>

        <article class="card">
          <h2>Camping Ramales</h2>
          <p class="hint">Cuevas · Montaña · Actividades</p>
          <div class="row">
            <a class="btn" href="https://www.campingramales.com" target="_blank" rel="noopener">Web</a>
            <a class="btn" href="tel:+34654463133">Llamar</a>
            <a class="btn" href="https://maps.google.com/?q=Camping+Ramales" target="_blank" rel="noopener">Cómo llegar</a>
            <a class="btn" href="https://wa.me/34654463133" target="_blank" rel="noopener">WhatsApp</a>
          </div>
          <div class="map"><iframe src="https://www.google.com/maps?q=Camping+Ramales&output=embed" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe></div>
        </article>

        <article class="card">
          <h2>Camping El Helguero (Ruiloba)</h2>
          <p class="hint">Naturaleza · Familiar · Mascotas</p>
          <div class="row">
            <a class="btn" href="https://www.campingelhelguero.com" target="_blank" rel="noopener">Web</a>
            <a class="btn" href="tel:+34942722124">Llamar</a>
            <a class="btn" href="https://maps.google.com/?q=Camping+El+Helguero" target="_blank" rel="noopener">Cómo llegar</a>
            <a class="btn" href="https://wa.me/34652806564" target="_blank" rel="noopener">WhatsApp</a>
          </div>
          <div class="map"><iframe src="https://www.google.com/maps?q=Camping+El+Helguero&output=embed" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe></div>
        </article>
      </div>
    </section>

    <!-- Instalación PWA -->
    <section class="card">
      <h2>Instálame como app</h2>
      <p class="hint">Android: ⋮ → Instalar app. iOS: Compartir → Añadir a pantalla de inicio.</p>
      <button id="installBtn" class="btn install">Instalar ahora</button>
      <p id="pwaStatus" class="hint"></p>
    </section>

    <footer>
      © <span id="year"></span> Grupo A Cobijo · <span class="ok">Funciona sin conexión</span> ●
    </footer>
  </div>

<script>
  // Año
  document.getElementById('year').textContent = new Date().getFullYear();

  // Eventos (desde events.json)
  async function loadEvents(){
    try{
      const res = await fetch('./events.json', { cache: 'no-cache' });
      const data = await res.json();
      const wrap = document.getElementById('events');
      if(!data.length){ wrap.innerHTML = '<p class="hint">Pronto publicaremos aquí los próximos eventos.</p>'; return; }
      wrap.innerHTML = data.map(ev => `
        <div class="event-card">
          <div class="event-title">${ev.titulo}</div>
          <div class="event-meta">${ev.fecha} · ${ev.lugar}</div>
          <div class="hint">${ev.descripcion}</div>
        </div>
      `).join('');
    }catch(e){
      document.getElementById('events').innerHTML = '<p class="hint">Sin eventos por ahora.</p>';
    }
  }
  loadEvents();

  // Horarios (datos de ejemplo: edítalos)
  const HORARIOS = {
    oyambre: {
      titulo:"Oyambre",
      items:[
        "Recepción: 09:00–21:00",
        "Restaurante: 13:00–16:00 y 20:00–23:00",
        "Supermercado: 09:00–20:00",
        "Piscina (verano): 10:00–20:00"
      ]
    },
    ramales: {
      titulo:"Ramales",
      items:[
        "Recepción: 09:30–20:30",
        "Cafetería: 08:30–12:00 y 17:30–23:00",
        "Actividades: según programación",
        "Piscina (verano): 11:00–20:00"
      ]
    },
    ruiloba: {
      titulo:"Ruiloba (El Helguero)",
      items:[
        "Recepción: 09:00–21:00",
        "Restaurante: 13:00–16:00 y 20:00–23:00",
        "Supermercado: 09:30–19:30",
        "Piscina (verano): 10:30–20:00"
      ]
    }
  };

  const modal = document.getElementById('modalHorarios');
  const closeH = document.getElementById('closeHorarios');
  const wrapH  = document.getElementById('scheduleWrap');

  function openHorarios(key){
    const h = HORARIOS[key];
    if(!h) return;
    wrapH.innerHTML = `
      <h4>${h.titulo}</h4>
      <ul>${h.items.map(i=>`<li>${i}</li>`).join('')}</ul>
    `;
    modal.style.display = 'flex';
  }
  document.getElementById('h-oy').addEventListener('click', ()=>openHorarios('oyambre'));
  document.getElementById('h-ra').addEventListener('click', ()=>openHorarios('ramales'));
  document.getElementById('h-he').addEventListener('click', ()=>openHorarios('ruiloba'));
  closeH.addEventListener('click', ()=> modal.style.display='none');
  modal.addEventListener('click', (e)=>{ if(e.target===modal) modal.style.display='none'; });

  // Service Worker
  if ('serviceWorker' in navigator) navigator.serviceWorker.register('./service-worker.js');

  // Instalar PWA
  let deferredPrompt;
  const installBtn = document.getElementById('installBtn');
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installBtn.style.display = 'inline-flex';
  });
  installBtn.addEventListener('click', () => {
    deferredPrompt?.prompt(); deferredPrompt = null;
  });

  // Ocultar pre-splash
  window.addEventListener('load', () => {
    setTimeout(() => document.getElementById('appSplash')?.remove(), 650);
  });
</script>

</body>
</html>
