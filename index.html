<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <title>Grupo A Cobijo</title>

  <meta name="description" content="Tu gu√≠a en el camping: eventos, horarios, mapas y contacto del Grupo A Cobijo.">
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0ea5e9">
  <link rel="icon" href="assets/icons/icon-192.png">

  <!-- iOS modo App + status bar -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="apple-touch-icon" href="assets/icons/icon-192.png">

  <!-- Splash iPhone (portrait) con cache-busting -->
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-15pm-portrait.png?v=3" media="(device-width: 430px) and (device-height: 932px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-15p-portrait.png?v=3"  media="(device-width: 393px) and (device-height: 852px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-14-15-plus-portrait.png?v=3" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-12pm-portrait.png?v=3" media="(device-width: 428px) and (device-height: 926px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-12-14-portrait.png?v=3" media="(device-width: 390px) and (device-height: 844px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-x-11pro-portrait.png?v=3" media="(device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-11r-portrait.png?v=3" media="(device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-6-8-se2-portrait.png?v=3" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/iphone-5-se1-portrait.png?v=3" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <!-- iPad -->
  <link rel="apple-touch-startup-image" href="assets/splash/ipad-pro-12-9-portrait.png?v=3" media="(device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/ipad-pro-11-portrait.png?v=3"    media="(device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/ipad-pro-10-5-portrait.png?v=3"  media="(device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/ipad-9-7-portrait.png?v=3"       media="(device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">
  <link rel="apple-touch-startup-image" href="assets/splash/ipad-10-9-portrait.png?v=3"      media="(device-width: 820px) and (device-height: 1180px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)">

  <style>
    :root{
      --bg:#ffffff; --card:#f4f9ff; --accent:#0077cc; --muted:#6b7a8c;
      --text:#0a1a2a; --line:#dce7f5; --tint:#eaf4ff; --accent-ink:#064e89;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;background:#fff;color:var(--text)}
    .wrap{max-width:900px;margin:0 auto;padding:24px}

    /* Pre-splash interno (fallback) */
    .app-splash { position: fixed; inset: 0; background:#fff; display:grid; place-items:center; z-index:9999; }
    .app-splash img { width: 180px; height:auto; opacity:.98; }

    /* Header / hero */
    header{display:flex;align-items:center;gap:16px;margin:8px 0 12px;flex-wrap:wrap}
    .logo-img{height:80px;width:auto;object-fit:contain}
    h1{margin:0;font-size:1.4rem}
    .tag{color:var(--muted);font-size:.85rem}
    .spacer{flex:1}
    .pill{border:1px solid var(--line);background:var(--tint);padding:4px 10px;border-radius:999px;font-size:.8rem}

    /* Bot√≥n idioma + modal (reusa .modal/.modal-backdrop) */
    .lang-btn{
      appearance:none; border:1px solid var(--line); background:#fff;
      color:var(--accent-ink); padding:6px 12px; border-radius:12px;
      font-weight:700; display:inline-flex; align-items:center; gap:8px;
    }
    .lang-grid{display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:8px; margin-top:8px}
    .lang-option{
      width:100%; padding:10px 12px; border-radius:12px; border:1px solid var(--line);
      background:#fff; font-weight:600; text-align:left; cursor:pointer;
    }
    .lang-option:hover{background:var(--tint)}

    .hero{
      margin:8px 0 18px; background:linear-gradient(180deg,#f8fbff,#eef5ff);
      border:1px solid var(--line); border-radius:16px; padding:16px;
    }
    .hero h2{margin:0 0 6px; font-size:1.2rem}
    .hero p{margin:0; color:var(--muted)}

    /* Cards / grid */
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;margin:16px 0 28px}
    .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:0 6px 18px rgba(0,0,0,.06);display:flex;flex-direction:column;gap:12px}
    .card h2{margin:0 0 6px; font-size:1.1rem}

    /* Botones: fix iPhone */
    .row{display:flex;flex-wrap:wrap;gap:8px}
    .btn{
      appearance:none;border:1px solid var(--line);background:rgba(0,119,204,.08);
      color:var(--accent-ink);padding:10px 12px;border-radius:12px;text-decoration:none;
      display:flex;align-items:center;justify-content:center;font-weight:600;
      flex:1; min-width:120px;
    }
    .btn:hover{background:rgba(0,119,204,.14)}

    /* Mapas */
    .map{width:100%;aspect-ratio:16/10;border-radius:12px;overflow:hidden;border:1px solid var(--line)}
    .map iframe{width:100%;height:100%;border:0}

    /* Eventos */
    .event-card{background:#fff;border:1px solid var(--line);border-radius:14px;padding:12px}
    .event-title{font-weight:700}
    .event-meta{font-size:.9rem;color:var(--muted)}

    /* Modal gen√©rico (usado por horarios e idiomas) */
    .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:10001}
    .modal{width:min(92vw,520px);background:#fff;border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:0 10px 28px rgba(0,0,0,.2)}
    .modal .close{background:transparent;border:none;color:var(--muted);font-weight:700;float:right}

    /* Horarios */
    .schedule{border:1px solid var(--line);border-radius:12px;padding:12px;background:#fff}
    .schedule h4{margin:0 0 8px}
    .schedule ul{margin:0;padding-left:18px}
    .schedule li{margin:4px 0}

    footer{margin-top:8px;font-size:.9rem;opacity:.85}
    .ok{color:#21a653}
    .install{display:none}
  </style>
</head>

<body>
  <!-- Pre-splash interno: se oculta al cargar -->
  <div class="app-splash" id="appSplash">
    <img src="assets/logo.png" alt="A Cobijo">
  </div>

  <div class="wrap">
    <!-- Header -->
    <header>
      <img src="assets/logo.png" class="logo-img" alt="Grupo A Cobijo">
      <div>
        <h1 id="t-app">Grupo A Cobijo</h1>
        <div class="tag" id="t-subtitle">Tu estancia con nosotros ¬∑ Oyambre ¬∑ Ramales ¬∑ Ruiloba</div>
      </div>
      <div class="spacer"></div>
      <button class="lang-btn" id="langBtn" aria-haspopup="dialog" aria-controls="langModal" title="Idioma / Language">üåê ES</button>
      <span class="pill" id="t-pwa">PWA ‚Ä¢ Offline</span>
    </header>

    <!-- Modal selector de idioma -->
    <div class="modal-backdrop" id="langModal" role="dialog" aria-modal="true" aria-labelledby="langTitle" style="display:none">
      <div class="modal">
        <button class="close" id="closeLang" aria-label="Cerrar">‚úï</button>
        <h3 id="langTitle">Selecciona idioma</h3>
        <div class="lang-grid">
          <button class="lang-option" data-lang="es">üá™üá∏ Espa√±ol</button>
          <button class="lang-option" data-lang="en">üá¨üáß English</button>
          <button class="lang-option" data-lang="fr">üá´üá∑ Fran√ßais</button>
          <button class="lang-option" data-lang="de">üá©üá™ Deutsch</button>
          <button class="lang-option" data-lang="nl">üá≥üá± Nederlands</button>
        </div>
      </div>
    </div>

    <!-- Hero -->
    <section class="hero">
      <h2 id="t-hero-title">Tu gu√≠a en el camping</h2>
      <p id="t-hero-desc">Eventos, horarios, c√≥mo llegar y contacto ‚Äî todo en tu m√≥vil, tambi√©n sin cobertura.</p>
    </section>

    <!-- 1) EVENTOS (PRIMERO) -->
    <section>
      <h2 id="t-events-title">Eventos hoy y esta semana</h2>
      <div id="events" class="grid"></div>
    </section>

    <!-- 2) HORARIOS -->
    <section class="card">
      <h2 id="t-schedules-title">Horarios</h2>
      <p class="hint" id="t-schedules-hint">Recepci√≥n, restaurante, piscina, supermercado... elige tu camping.</p>
      <div class="row">
        <button class="btn" id="h-oy">Ver horarios Oyambre</button>
        <button class="btn" id="h-ra">Ver horarios Ramales</button>
        <button class="btn" id="h-he">Ver horarios Ruiloba</button>
      </div>
    </section>

    <!-- Modal horarios -->
    <div class="modal-backdrop" id="modalHorarios" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modal">
        <button class="close" id="closeHorarios" aria-label="Cerrar">‚úï</button>
        <h3 id="modalTitle">Horarios</h3>
        <div id="scheduleWrap" class="schedule"></div>
      </div>
    </div>

    <!-- 3) CAMPINGS (AL FINAL) -->
    <section style="margin-top:24px">
      <h2 id="t-campings-title">Nuestros campings</h2>

      <div class="grid">
        <article class="card">
          <h2 id="t-oy-title">Camping Caravaning Playa de Oyambre</h2>
          <p class="hint" id="t-oy-hint">Todos los servicios ¬∑ Frente al mar</p>
          <div class="row">
            <a class="btn" data-i18n-web href="https://www.oyambre.com" target="_blank" rel="noopener">Web</a>
            <a class="btn" data-i18n-call href="tel:+34942711461">Llamar</a>
            <a class="btn" data-i18n-directions href="https://maps.google.com/?q=Camping+Caravaning+Playa+de+Oyambre" target="_blank" rel="noopener">C√≥mo llegar</a>
            <a class="btn" data-i18n-whatsapp href="https://wa.me/34675696212" target="_blank" rel="noopener">WhatsApp</a>
          </div>
          <div class="map"><iframe src="https://www.google.com/maps?q=Camping+Caravaning+Playa+de+Oyambre&output=embed" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe></div>
        </article>

        <article class="card">
          <h2 id="t-ra-title">Camping Ramales</h2>
          <p class="hint" id="t-ra-hint">Cuevas ¬∑ Monta√±a ¬∑ Actividades</p>
          <div class="row">
            <a class="btn" data-i18n-web href="https://www.campingramales.com" target="_blank" rel="noopener">Web</a>
            <a class="btn" data-i18n-call href="tel:+34654463133">Llamar</a>
            <a class="btn" data-i18n-directions href="https://maps.google.com/?q=Camping+Ramales" target="_blank" rel="noopener">C√≥mo llegar</a>
            <a class="btn" data-i18n-whatsapp href="https://wa.me/34654463133" target="_blank" rel="noopener">WhatsApp</a>
          </div>
          <div class="map"><iframe src="https://www.google.com/maps?q=Camping+Ramales&output=embed" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe></div>
        </article>

        <article class="card">
          <h2 id="t-he-title">Camping El Helguero (Ruiloba)</h2>
          <p class="hint" id="t-he-hint">Naturaleza ¬∑ Familiar ¬∑ Mascotas</p>
          <div class="row">
            <a class="btn" data-i18n-web href="https://www.campingelhelguero.com" target="_blank" rel="noopener">Web</a>
            <a class="btn" data-i18n-call href="tel:+34942722124">Llamar</a>
            <a class="btn" data-i18n-directions href="https://maps.google.com/?q=Camping+El+Helguero" target="_blank" rel="noopener">C√≥mo llegar</a>
            <a class="btn" data-i18n-whatsapp href="https://wa.me/34942722124" target="_blank" rel="noopener">WhatsApp</a>
          </div>
          <div class="map"><iframe src="https://www.google.com/maps?q=Camping+El+Helguero&output=embed" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe></div>
        </article>
      </div>
    </section>

    <!-- Instalaci√≥n PWA -->
    <section class="card">
      <h2 id="t-install-title">Inst√°lame como app</h2>
      <p class="hint" id="t-install-hint">Android: ‚ãÆ ‚Üí Instalar app. iOS: Compartir ‚Üí A√±adir a pantalla de inicio.</p>
      <button id="installBtn" class="btn install">Instalar ahora</button>
      <p id="pwaStatus" class="hint"></p>
    </section>

    <footer>
      ¬© <span id="year"></span> Grupo A Cobijo ¬∑ <span class="ok" id="t-offline">Funciona sin conexi√≥n</span> ‚óè
    </footer>
  </div>

<script>
  // A√±o
  document.getElementById('year').textContent = new Date().getFullYear();

  // ---------------------- I18N COMPLETO ----------------------
  const I18N = {
    es: {
      app: "Grupo A Cobijo",
      subtitle: "Tu estancia con nosotros ¬∑ Oyambre ¬∑ Ramales ¬∑ Ruiloba",
      heroTitle: "Tu gu√≠a en el camping",
      heroDesc: "Eventos, horarios, c√≥mo llegar y contacto ‚Äî todo en tu m√≥vil, tambi√©n sin cobertura.",
      eventsTitle: "Eventos hoy y esta semana",
      schedulesTitle: "Horarios",
      schedulesHint: "Recepci√≥n, restaurante, piscina, supermercado... elige tu camping.",
      campingsTitle: "Nuestros campings",
      installTitle: "Inst√°lame como app",
      installHint: "Android: ‚ãÆ ‚Üí Instalar app. iOS: Compartir ‚Üí A√±adir a pantalla de inicio.",
      offline: "Funciona sin conexi√≥n",
      hOy: "Ver horarios Oyambre", hRa: "Ver horarios Ramales", hHe: "Ver horarios Ruiloba",
      web: "Web", call: "Llamar", directions: "C√≥mo llegar", whatsapp: "WhatsApp",
      oyTitle:"Camping Caravaning Playa de Oyambre", oyHint:"Todos los servicios ¬∑ Frente al mar",
      raTitle:"Camping Ramales", raHint:"Cuevas ¬∑ Monta√±a ¬∑ Actividades",
      heTitle:"Camping El Helguero (Ruiloba)", heHint:"Naturaleza ¬∑ Familiar ¬∑ Mascotas",
      langTitle: "Selecciona idioma", pwa:"PWA ‚Ä¢ Offline"
    },
    en: {
      app:"Grupo A Cobijo",
      subtitle:"Your stay with us ¬∑ Oyambre ¬∑ Ramales ¬∑ Ruiloba",
      heroTitle:"Your on-site guide",
      heroDesc:"Events, schedules, directions and contact ‚Äî right on your phone, even offline.",
      eventsTitle:"Today's & this week's events",
      schedulesTitle:"Schedules",
      schedulesHint:"Reception, restaurant, pool, supermarket... choose your campsite.",
      campingsTitle:"Our campsites",
      installTitle:"Install me as an app",
      installHint:"Android: ‚ãÆ ‚Üí Install app. iOS: Share ‚Üí Add to Home Screen.",
      offline:"Works offline",
      hOy:"View schedules Oyambre", hRa:"View schedules Ramales", hHe:"View schedules Ruiloba",
      web:"Website", call:"Call", directions:"Directions", whatsapp:"WhatsApp",
      oyTitle:"Camping Caravaning Playa de Oyambre", oyHint:"All services ¬∑ By the sea",
      raTitle:"Camping Ramales", raHint:"Caves ¬∑ Mountains ¬∑ Activities",
      heTitle:"Camping El Helguero (Ruiloba)", heHint:"Nature ¬∑ Family ¬∑ Pets",
      langTitle:"Choose language", pwa:"PWA ‚Ä¢ Offline"
    },
    fr: {
      app:"Groupe A Cobijo",
      subtitle:"Votre s√©jour avec nous ¬∑ Oyambre ¬∑ Ramales ¬∑ Ruiloba",
      heroTitle:"Votre guide sur place",
      heroDesc:"√âv√©nements, horaires, itin√©raires et contacts ‚Äî sur votre mobile, m√™me hors ligne.",
      eventsTitle:"√âv√©nements aujourd‚Äôhui et cette semaine",
      schedulesTitle:"Horaires",
      schedulesHint:"R√©ception, restaurant, piscine, supermarch√©‚Ä¶ choisissez votre camping.",
      campingsTitle:"Nos campings",
      installTitle:"Installe-moi comme application",
      installHint:"Android : ‚ãÆ ‚Üí Installer l‚Äôapp. iOS : Partager ‚Üí Sur l‚Äô√©cran d‚Äôaccueil.",
      offline:"Fonctionne hors ligne",
      hOy:"Voir horaires Oyambre", hRa:"Voir horaires Ramales", hHe:"Voir horaires Ruiloba",
      web:"Site web", call:"Appeler", directions:"Itin√©raire", whatsapp:"WhatsApp",
      oyTitle:"Camping Caravaning Playa de Oyambre", oyHint:"Tous services ¬∑ Bord de mer",
      raTitle:"Camping Ramales", raHint:"Grottes ¬∑ Montagne ¬∑ Activit√©s",
      heTitle:"Camping El Helguero (Ruiloba)", heHint:"Nature ¬∑ Famille ¬∑ Animaux admis",
      langTitle:"Choisir la langue", pwa:"PWA ‚Ä¢ Hors ligne"
    },
    de: {
      app:"Gruppe A Cobijo",
      subtitle:"Ihr Aufenthalt bei uns ¬∑ Oyambre ¬∑ Ramales ¬∑ Ruiloba",
      heroTitle:"Dein Guide vor Ort",
      heroDesc:"Events, √ñffnungszeiten, Anfahrt und Kontakt ‚Äî alles auf deinem Handy, auch offline.",
      eventsTitle:"Events heute & diese Woche",
      schedulesTitle:"√ñffnungszeiten",
      schedulesHint:"Rezeption, Restaurant, Pool, Supermarkt ‚Ä¶ w√§hle deinen Campingplatz.",
      campingsTitle:"Unsere Campingpl√§tze",
      installTitle:"Als App installieren",
      installHint:"Android: ‚ãÆ ‚Üí App installieren. iOS: Teilen ‚Üí Zum Home-Bildschirm.",
      offline:"Funktioniert offline",
      hOy:"Zeiten ansehen Oyambre", hRa:"Zeiten ansehen Ramales", hHe:"Zeiten ansehen Ruiloba",
      web:"Webseite", call:"Anrufen", directions:"Anfahrt", whatsapp:"WhatsApp",
      oyTitle:"Camping Caravaning Playa de Oyambre", oyHint:"Alle Services ¬∑ Am Meer",
      raTitle:"Camping Ramales", raHint:"H√∂hlen ¬∑ Berge ¬∑ Aktivit√§ten",
      heTitle:"Camping El Helguero (Ruiloba)", heHint:"Natur ¬∑ Familie ¬∑ Haustiere",
      langTitle:"Sprache w√§hlen", pwa:"PWA ‚Ä¢ Offline"
    },
    nl: {
      app:"Groep A Cobijo",
      subtitle:"Je verblijf bij ons ¬∑ Oyambre ¬∑ Ramales ¬∑ Ruiloba",
      heroTitle:"Je gids op de camping",
      heroDesc:"Evenementen, tijden, route en contact ‚Äî op je telefoon, ook offline.",
      eventsTitle:"Events vandaag en deze week",
      schedulesTitle:"Openingstijden",
      schedulesHint:"Receptie, restaurant, zwembad, supermarkt‚Ä¶ kies je camping.",
      campingsTitle:"Onze campings",
      installTitle:"Installeer als app",
      installHint:"Android: ‚ãÆ ‚Üí App installeren. iOS: Delen ‚Üí Zet op beginscherm.",
      offline:"Werkt offline",
      hOy:"Tijden bekijken Oyambre", hRa:"Tijden bekijken Ramales", hHe:"Tijden bekijken Ruiloba",
      web:"Website", call:"Bellen", directions:"Route", whatsapp:"WhatsApp",
      oyTitle:"Camping Caravaning Playa de Oyambre", oyHint:"Alle faciliteiten ¬∑ Aan zee",
      raTitle:"Camping Ramales", raHint:"Grotten ¬∑ Bergen ¬∑ Activiteiten",
      heTitle:"Camping El Helguero (Ruiloba)", heHint:"Natuur ¬∑ Familie ¬∑ Huisdieren",
      langTitle:"Taal kiezen", pwa:"PWA ‚Ä¢ Offline"
    }
  };

  function detectLang(){
    const saved = localStorage.getItem('lang');
    if (saved) return saved;
    const n = (navigator.language || 'es').slice(0,2).toLowerCase();
    return ['es','en','fr','de','nl'].includes(n) ? n : 'es';
  }
  function setLangBadge(lang){
    const map = {es:'ES', en:'EN', fr:'FR', de:'DE', nl:'NL'};
    const btn = document.getElementById('langBtn');
    if (btn) btn.textContent = `üåê ${map[lang]||'ES'}`;
  }
  function applyLang(lang){
    const T = I18N[lang] || I18N.es;
    document.getElementById("t-app").textContent = T.app;
    document.getElementById("t-subtitle").textContent = T.subtitle;
    document.getElementById("t-pwa").textContent = T.pwa;
    document.getElementById("t-hero-title").textContent = T.heroTitle;
    document.getElementById("t-hero-desc").textContent  = T.heroDesc;
    document.getElementById("t-events-title").textContent = T.eventsTitle;
    document.getElementById("t-schedules-title").textContent = T.schedulesTitle;
    document.getElementById("t-schedules-hint").textContent = T.schedulesHint;
    document.getElementById("t-campings-title").textContent = T.campingsTitle;
    document.getElementById("t-install-title").textContent = T.installTitle;
    document.getElementById("t-install-hint").textContent = T.installHint;
    document.getElementById("h-oy").textContent = T.hOy;
    document.getElementById("h-ra").textContent = T.hRa;
    document.getElementById("h-he").textContent = T.hHe;
    document.getElementById("t-oy-title").textContent = T.oyTitle;
    document.getElementById("t-oy-hint").textContent  = T.oyHint;
    document.getElementById("t-ra-title").textContent = T.raTitle;
    document.getElementById("t-ra-hint").textContent  = T.raHint;
    document.getElementById("t-he-title").textContent = T.heTitle;
    document.getElementById("t-he-hint").textContent  = T.heHint;
    document.getElementById("langTitle").textContent = T.langTitle;
    document.querySelectorAll("[data-i18n-web]").forEach(el => el.textContent = T.web);
    document.querySelectorAll("[data-i18n-call]").forEach(el => el.textContent = T.call);
    document.querySelectorAll("[data-i18n-directions]").forEach(el => el.textContent = T.directions);
    document.querySelectorAll("[data-i18n-whatsapp]").forEach(el => el.textContent = T.whatsapp);
    setLangBadge(lang);
    localStorage.setItem("lang", lang);
    loadEvents(); // re-render eventos en el nuevo idioma
  }

  // --------------- Auto-traducci√≥n de eventos ---------------
  function currentLang(){ return localStorage.getItem('lang') || detectLang() || 'es'; }
  const GLOSSARY = {
    en: [[/concierto/gi,"concert"],[/nochebuena/gi,"Christmas Eve"],[/entrada libre/gi,"free entry"],[/chocolate caliente/gi,"hot chocolate"],[/hoy/gi,"today"],[/ma√±ana/gi,"tomorrow"],[/tarde/gi,"afternoon"],[/noche/gi,"night"],[/en/gi,"in"],[/a las/gi,"at"]],
    fr: [[/concierto/gi,"concert"],[/nochebuena/gi,"R√©veillon"],[/entrada libre/gi,"entr√©e libre"],[/chocolate caliente/gi,"chocolat chaud"],[/hoy/gi,"aujourd‚Äôhui"],[/ma√±ana/gi,"demain"],[/tarde/gi,"apr√®s-midi"],[/noche/gi,"soir"],[/en/gi,"√†"],[/a las/gi,"√†"]],
    de: [[/concierto/gi,"Konzert"],[/nochebuena/gi,"Heiligabend"],[/entrada libre/gi,"Eintritt frei"],[/chocolate caliente/gi,"hei√üe Schokolade"],[/hoy/gi,"heute"],[/ma√±ana/gi,"morgen"],[/tarde/gi,"Nachmittag"],[/noche/gi,"Abend"],[/en/gi,"in"],[/a las/gi,"um"]],
    nl: [[/concierto/gi,"concert"],[/nochebuena/gi,"Kerstavond"],[/entrada libre/gi,"gratis toegang"],[/chocolate caliente/gi,"warme chocolademelk"],[/hoy/gi,"vandaag"],[/ma√±ana/gi,"morgen"],[/tarde/gi,"middag"],[/noche/gi,"avond"],[/en/gi,"in"],[/a las/gi,"om"]]
  };
  function autoTranslateFromEs(text, lang){
    if (!text || lang === 'es') return text;
    const rules = GLOSSARY[lang]; if (!rules) return text;
    let out = text; for (const [re,repl] of rules) out = out.replace(re, repl);
    return out;
  }
  function i18nField(value, lang){
    if (!value) return '';
    if (typeof value === 'string') return autoTranslateFromEs(value, lang);
    if (typeof value === 'object') return value[lang] || value.es || '';
    return '';
  }
  function formatEventDate(iso, lang){
    try{
      const d = new Date(iso);
      return new Intl.DateTimeFormat(lang, { weekday:'long', day:'numeric', month:'long', hour:'2-digit', minute:'2-digit'}).format(d);
    }catch(e){ return iso; }
  }
  function renderEvent(ev, lang){
    const t = i18nField(ev.titulo, lang) || '(sin t√≠tulo)';
    const d = i18nField(ev.descripcion, lang) || '';
    const place = i18nField(ev.lugar, lang) || (ev.camping || '');
    const when = formatEventDate(ev.fecha, lang);
    return `
      <div class="event-card">
        <div class="event-title">${t}</div>
        <div class="event-meta">${when} ¬∑ ${place}</div>
        <div class="hint">${d}</div>
      </div>
    `;
  }
  async function loadEvents(){
    const lang = currentLang();
    try{
      const res = await fetch('./events.json', { cache: 'no-cache' });
      const data = await res.json();
      const wrap = document.getElementById('events');
      if (!Array.isArray(data) || data.length === 0){
        wrap.innerHTML = '<p class="hint">Sin eventos por ahora.</p>'; return;
      }
      data.sort((a,b)=> new Date(a.fecha) - new Date(b.fecha));
      wrap.innerHTML = data.map(ev => renderEvent(ev, lang)).join('');
    }catch(e){
      document.getElementById('events').innerHTML = '<p class="hint">Sin eventos por ahora.</p>';
    }
  }

  // Horarios (ejemplo editable)
  const HORARIOS = {
    oyambre: { titulo:"Oyambre", items:["Recepci√≥n: 09:00‚Äì21:00","Restaurante: 13:00‚Äì16:00 y 20:00‚Äì23:00","Supermercado: 09:00‚Äì20:00","Piscina (verano): 10:00‚Äì20:00"] },
    ramales: { titulo:"Ramales", items:["Recepci√≥n: 09:30‚Äì20:30","Cafeter√≠a: 08:30‚Äì12:00 y 17:30‚Äì23:00","Actividades: seg√∫n programaci√≥n","Piscina (verano): 11:00‚Äì20:00"] },
    ruiloba: { titulo:"Ruiloba (El Helguero)", items:["Recepci√≥n: 09:00‚Äì21:00","Restaurante: 13:00‚Äì16:00 y 20:00‚Äì23:00","Supermercado: 09:30‚Äì19:30","Piscina (verano): 10:30‚Äì20:00"] }
  };

  // Modal horarios
  const modal = document.getElementById('modalHorarios');
  const closeH = document.getElementById('closeHorarios');
  const wrapH  = document.getElementById('scheduleWrap');
  function openHorarios(key){
    const h = HORARIOS[key]; if(!h) return;
    wrapH.innerHTML = `<h4>${h.titulo}</h4><ul>${h.items.map(i=>`<li>${i}</li>`).join('')}</ul>`;
    modal.style.display = 'flex';
  }
  document.getElementById('h-oy').addEventListener('click', ()=>openHorarios('oyambre'));
  document.getElementById('h-ra').addEventListener('click', ()=>openHorarios('ramales'));
  document.getElementById('h-he').addEventListener('click', ()=>openHorarios('ruiloba'));
  closeH.addEventListener('click', ()=> modal.style.display='none');
  modal.addEventListener('click', (e)=>{ if(e.target===modal) modal.style.display='none'; });

  // Selector de idioma (modal)
  const langBtn   = document.getElementById('langBtn');
  const langModal = document.getElementById('langModal');
  const closeLang = document.getElementById('closeLang');
  langBtn?.addEventListener('click', ()=> { langModal.style.display='flex'; });
  closeLang?.addEventListener('click', ()=> { langModal.style.display='none'; });
  langModal?.addEventListener('click', (e)=>{ if(e.target===langModal) langModal.style.display='none'; });
  document.querySelectorAll('.lang-option').forEach(b=>{
    b.addEventListener('click', ()=>{
      const code = b.getAttribute('data-lang');
      applyLang(code);
      langModal.style.display='none';
    });
  });

  // Inicializaci√≥n
  const initialLang = detectLang();
  applyLang(initialLang);
  loadEvents();

  // Service Worker
  if ('serviceWorker' in navigator) navigator.serviceWorker.register('./service-worker.js');

  // Instalar PWA
  let deferredPrompt;
  const installBtn = document.getElementById('installBtn');
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installBtn.style.display = 'inline-flex';
  });
  installBtn.addEventListener('click', () => { deferredPrompt?.prompt(); deferredPrompt = null; });

  // Ocultar pre-splash
  window.addEventListener('load', () => {
    setTimeout(() => document.getElementById('appSplash')?.remove(), 650);
  });
</script>

</body>
</html>
